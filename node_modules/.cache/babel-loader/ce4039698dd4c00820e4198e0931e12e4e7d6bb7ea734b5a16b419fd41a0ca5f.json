{"ast":null,"code":"import { h, defineComponent, ref, computed, inject } from 'vue';\nimport { FilterIcon } from '../../../_internal/icons';\nimport { NBaseIcon } from '../../../_internal';\nimport { NPopover } from '../../../popover';\nimport RenderFilter from './RenderFilter';\nimport NDataTableFilterMenu from './FilterMenu';\nimport { dataTableInjectionKey } from '../interface';\nimport { useConfig } from '../../../_mixins';\nfunction createFilterState(currentFilterState, columnKey, mergedFilterValue) {\n  const nextFilterState = Object.assign({}, currentFilterState);\n  nextFilterState[columnKey] = mergedFilterValue;\n  return nextFilterState;\n}\nexport default defineComponent({\n  name: 'DataTableFilterButton',\n  props: {\n    column: {\n      type: Object,\n      required: true\n    },\n    options: {\n      type: Array,\n      default: () => []\n    }\n  },\n  setup(props) {\n    const {\n      mergedComponentPropsRef\n    } = useConfig();\n    const {\n      mergedThemeRef,\n      mergedClsPrefixRef,\n      mergedFilterStateRef,\n      filterMenuCssVarsRef,\n      paginationBehaviorOnFilterRef,\n      doUpdatePage,\n      doUpdateFilters\n      // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n    } = inject(dataTableInjectionKey);\n    const showPopoverRef = ref(false);\n    const filterStateRef = mergedFilterStateRef;\n    const filterMultipleRef = computed(() => {\n      return props.column.filterMultiple !== false;\n    });\n    const mergedFilterValueRef = computed(() => {\n      const filterValue = filterStateRef.value[props.column.key];\n      if (filterValue === undefined) {\n        const {\n          value: multiple\n        } = filterMultipleRef;\n        if (multiple) return [];else return null;\n      }\n      return filterValue;\n    });\n    const activeRef = computed(() => {\n      const {\n        value: filterValue\n      } = mergedFilterValueRef;\n      if (Array.isArray(filterValue)) {\n        return filterValue.length > 0;\n      }\n      return filterValue !== null;\n    });\n    const mergedRenderFilterRef = computed(() => {\n      var _a, _b;\n      return ((_b = (_a = mergedComponentPropsRef === null || mergedComponentPropsRef === void 0 ? void 0 : mergedComponentPropsRef.value) === null || _a === void 0 ? void 0 : _a.DataTable) === null || _b === void 0 ? void 0 : _b.renderFilter) || props.column.renderFilter;\n    });\n    function handleFilterChange(mergedFilterValue) {\n      const nextFilterState = createFilterState(filterStateRef.value, props.column.key, mergedFilterValue);\n      doUpdateFilters(nextFilterState, props.column);\n      if (paginationBehaviorOnFilterRef.value === 'first') {\n        doUpdatePage(1);\n      }\n    }\n    function handleFilterMenuCancel() {\n      showPopoverRef.value = false;\n    }\n    function handleFilterMenuConfirm() {\n      showPopoverRef.value = false;\n    }\n    return {\n      mergedTheme: mergedThemeRef,\n      mergedClsPrefix: mergedClsPrefixRef,\n      active: activeRef,\n      showPopover: showPopoverRef,\n      mergedRenderFilter: mergedRenderFilterRef,\n      filterMultiple: filterMultipleRef,\n      mergedFilterValue: mergedFilterValueRef,\n      filterMenuCssVars: filterMenuCssVarsRef,\n      handleFilterChange,\n      handleFilterMenuConfirm,\n      handleFilterMenuCancel\n    };\n  },\n  render() {\n    const {\n      mergedTheme,\n      mergedClsPrefix,\n      handleFilterMenuCancel\n    } = this;\n    return h(NPopover, {\n      show: this.showPopover,\n      onUpdateShow: v => this.showPopover = v,\n      trigger: \"click\",\n      theme: mergedTheme.peers.Popover,\n      themeOverrides: mergedTheme.peerOverrides.Popover,\n      placement: \"bottom\",\n      style: {\n        padding: 0\n      }\n    }, {\n      trigger: () => {\n        const {\n          mergedRenderFilter\n        } = this;\n        if (mergedRenderFilter) {\n          return h(RenderFilter, {\n            \"data-data-table-filter\": true,\n            render: mergedRenderFilter,\n            active: this.active,\n            show: this.showPopover\n          });\n        }\n        const {\n          renderFilterIcon\n        } = this.column;\n        return h(\"div\", {\n          \"data-data-table-filter\": true,\n          class: [`${mergedClsPrefix}-data-table-filter`, {\n            [`${mergedClsPrefix}-data-table-filter--active`]: this.active,\n            [`${mergedClsPrefix}-data-table-filter--show`]: this.showPopover\n          }]\n        }, renderFilterIcon ? renderFilterIcon({\n          active: this.active,\n          show: this.showPopover\n        }) : h(NBaseIcon, {\n          clsPrefix: mergedClsPrefix\n        }, {\n          default: () => h(FilterIcon, null)\n        }));\n      },\n      default: () => {\n        const {\n          renderFilterMenu\n        } = this.column;\n        return renderFilterMenu ? renderFilterMenu({\n          hide: handleFilterMenuCancel\n        }) : h(NDataTableFilterMenu, {\n          style: this.filterMenuCssVars,\n          radioGroupName: String(this.column.key),\n          multiple: this.filterMultiple,\n          value: this.mergedFilterValue,\n          options: this.options,\n          column: this.column,\n          onChange: this.handleFilterChange,\n          onClear: this.handleFilterMenuCancel,\n          onConfirm: this.handleFilterMenuConfirm\n        });\n      }\n    });\n  }\n});","map":{"version":3,"names":["h","defineComponent","ref","computed","inject","FilterIcon","NBaseIcon","NPopover","RenderFilter","NDataTableFilterMenu","dataTableInjectionKey","useConfig","createFilterState","currentFilterState","columnKey","mergedFilterValue","nextFilterState","Object","assign","name","props","column","type","required","options","Array","default","setup","mergedComponentPropsRef","mergedThemeRef","mergedClsPrefixRef","mergedFilterStateRef","filterMenuCssVarsRef","paginationBehaviorOnFilterRef","doUpdatePage","doUpdateFilters","showPopoverRef","filterStateRef","filterMultipleRef","filterMultiple","mergedFilterValueRef","filterValue","value","key","undefined","multiple","activeRef","isArray","length","mergedRenderFilterRef","_a","_b","DataTable","renderFilter","handleFilterChange","handleFilterMenuCancel","handleFilterMenuConfirm","mergedTheme","mergedClsPrefix","active","showPopover","mergedRenderFilter","filterMenuCssVars","render","show","onUpdateShow","v","trigger","theme","peers","Popover","themeOverrides","peerOverrides","placement","style","padding","renderFilterIcon","class","clsPrefix","renderFilterMenu","hide","radioGroupName","String","onChange","onClear","onConfirm"],"sources":["/Users/elmo/GitHub/meetings_vue3/node_modules/naive-ui/es/data-table/src/HeaderButton/FilterButton.js"],"sourcesContent":["import { h, defineComponent, ref, computed, inject } from 'vue';\nimport { FilterIcon } from '../../../_internal/icons';\nimport { NBaseIcon } from '../../../_internal';\nimport { NPopover } from '../../../popover';\nimport RenderFilter from './RenderFilter';\nimport NDataTableFilterMenu from './FilterMenu';\nimport { dataTableInjectionKey } from '../interface';\nimport { useConfig } from '../../../_mixins';\nfunction createFilterState(currentFilterState, columnKey, mergedFilterValue) {\n    const nextFilterState = Object.assign({}, currentFilterState);\n    nextFilterState[columnKey] = mergedFilterValue;\n    return nextFilterState;\n}\nexport default defineComponent({\n    name: 'DataTableFilterButton',\n    props: {\n        column: {\n            type: Object,\n            required: true\n        },\n        options: {\n            type: Array,\n            default: () => []\n        }\n    },\n    setup(props) {\n        const { mergedComponentPropsRef } = useConfig();\n        const { mergedThemeRef, mergedClsPrefixRef, mergedFilterStateRef, filterMenuCssVarsRef, paginationBehaviorOnFilterRef, doUpdatePage, doUpdateFilters\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(dataTableInjectionKey);\n        const showPopoverRef = ref(false);\n        const filterStateRef = mergedFilterStateRef;\n        const filterMultipleRef = computed(() => {\n            return props.column.filterMultiple !== false;\n        });\n        const mergedFilterValueRef = computed(() => {\n            const filterValue = filterStateRef.value[props.column.key];\n            if (filterValue === undefined) {\n                const { value: multiple } = filterMultipleRef;\n                if (multiple)\n                    return [];\n                else\n                    return null;\n            }\n            return filterValue;\n        });\n        const activeRef = computed(() => {\n            const { value: filterValue } = mergedFilterValueRef;\n            if (Array.isArray(filterValue)) {\n                return filterValue.length > 0;\n            }\n            return filterValue !== null;\n        });\n        const mergedRenderFilterRef = computed(() => {\n            var _a, _b;\n            return (((_b = (_a = mergedComponentPropsRef === null || mergedComponentPropsRef === void 0 ? void 0 : mergedComponentPropsRef.value) === null || _a === void 0 ? void 0 : _a.DataTable) === null || _b === void 0 ? void 0 : _b.renderFilter) ||\n                props.column.renderFilter);\n        });\n        function handleFilterChange(mergedFilterValue) {\n            const nextFilterState = createFilterState(filterStateRef.value, props.column.key, mergedFilterValue);\n            doUpdateFilters(nextFilterState, props.column);\n            if (paginationBehaviorOnFilterRef.value === 'first') {\n                doUpdatePage(1);\n            }\n        }\n        function handleFilterMenuCancel() {\n            showPopoverRef.value = false;\n        }\n        function handleFilterMenuConfirm() {\n            showPopoverRef.value = false;\n        }\n        return {\n            mergedTheme: mergedThemeRef,\n            mergedClsPrefix: mergedClsPrefixRef,\n            active: activeRef,\n            showPopover: showPopoverRef,\n            mergedRenderFilter: mergedRenderFilterRef,\n            filterMultiple: filterMultipleRef,\n            mergedFilterValue: mergedFilterValueRef,\n            filterMenuCssVars: filterMenuCssVarsRef,\n            handleFilterChange,\n            handleFilterMenuConfirm,\n            handleFilterMenuCancel\n        };\n    },\n    render() {\n        const { mergedTheme, mergedClsPrefix, handleFilterMenuCancel } = this;\n        return (h(NPopover, { show: this.showPopover, onUpdateShow: (v) => (this.showPopover = v), trigger: \"click\", theme: mergedTheme.peers.Popover, themeOverrides: mergedTheme.peerOverrides.Popover, placement: \"bottom\", style: { padding: 0 } }, {\n            trigger: () => {\n                const { mergedRenderFilter } = this;\n                if (mergedRenderFilter) {\n                    return (h(RenderFilter, { \"data-data-table-filter\": true, render: mergedRenderFilter, active: this.active, show: this.showPopover }));\n                }\n                const { renderFilterIcon } = this.column;\n                return (h(\"div\", { \"data-data-table-filter\": true, class: [\n                        `${mergedClsPrefix}-data-table-filter`,\n                        {\n                            [`${mergedClsPrefix}-data-table-filter--active`]: this.active,\n                            [`${mergedClsPrefix}-data-table-filter--show`]: this.showPopover\n                        }\n                    ] }, renderFilterIcon ? (renderFilterIcon({\n                    active: this.active,\n                    show: this.showPopover\n                })) : (h(NBaseIcon, { clsPrefix: mergedClsPrefix }, { default: () => h(FilterIcon, null) }))));\n            },\n            default: () => {\n                const { renderFilterMenu } = this.column;\n                return renderFilterMenu ? (renderFilterMenu({ hide: handleFilterMenuCancel })) : (h(NDataTableFilterMenu, { style: this.filterMenuCssVars, radioGroupName: String(this.column.key), multiple: this.filterMultiple, value: this.mergedFilterValue, options: this.options, column: this.column, onChange: this.handleFilterChange, onClear: this.handleFilterMenuCancel, onConfirm: this.handleFilterMenuConfirm }));\n            }\n        }));\n    }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}