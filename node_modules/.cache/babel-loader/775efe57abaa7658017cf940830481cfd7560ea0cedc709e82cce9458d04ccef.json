{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nvar __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\nimport { h, defineComponent, computed, provide, toRef, ref, Fragment, Teleport, nextTick } from 'vue';\nimport { createId } from 'seemly';\nimport { useMergedState } from 'vooks';\nimport { useConfig, useTheme, useFormItem, useThemeClass } from '../../_mixins';\nimport { warn, call, throwError } from '../../_utils';\nimport { uploadLight } from '../styles';\nimport { uploadDraggerKey } from './UploadDragger';\nimport { uploadInjectionKey } from './interface';\nimport { createImageDataUrl, createSettledFileInfo, matchType } from './utils';\nimport NUploadTrigger from './UploadTrigger';\nimport NUploadFileList from './UploadFileList';\nimport style from './styles/index.cssr';\n/**\n * fils status ['pending', 'uploading', 'finished', 'removed', 'error']\n */\nfunction createXhrHandlers(inst, file, xhr) {\n  const {\n    doChange,\n    xhrMap\n  } = inst;\n  let percentage = 0;\n  function handleXHRError(e) {\n    var _a;\n    let fileAfterChange = Object.assign({}, file, {\n      status: 'error',\n      percentage\n    });\n    xhrMap.delete(file.id);\n    fileAfterChange = createSettledFileInfo(((_a = inst.onError) === null || _a === void 0 ? void 0 : _a.call(inst, {\n      file: fileAfterChange,\n      event: e\n    })) || fileAfterChange);\n    doChange(fileAfterChange, e);\n  }\n  function handleXHRLoad(e) {\n    var _a;\n    if (inst.isErrorState) {\n      if (inst.isErrorState(xhr)) {\n        handleXHRError(e);\n        return;\n      }\n    } else {\n      if (xhr.status < 200 || xhr.status >= 300) {\n        handleXHRError(e);\n        return;\n      }\n    }\n    let fileAfterChange = Object.assign({}, file, {\n      status: 'finished',\n      percentage,\n      file: null\n    });\n    xhrMap.delete(file.id);\n    fileAfterChange = createSettledFileInfo(((_a = inst.onFinish) === null || _a === void 0 ? void 0 : _a.call(inst, {\n      file: fileAfterChange,\n      event: e\n    })) || fileAfterChange);\n    doChange(fileAfterChange, e);\n  }\n  return {\n    handleXHRLoad,\n    handleXHRError,\n    handleXHRAbort(e) {\n      const fileAfterChange = Object.assign({}, file, {\n        status: 'removed',\n        file: null,\n        percentage\n      });\n      xhrMap.delete(file.id);\n      doChange(fileAfterChange, e);\n    },\n    handleXHRProgress(e) {\n      const fileAfterChange = Object.assign({}, file, {\n        status: 'uploading'\n      });\n      if (e.lengthComputable) {\n        const progress = Math.ceil(e.loaded / e.total * 100);\n        fileAfterChange.percentage = progress;\n        percentage = progress;\n      }\n      doChange(fileAfterChange, e);\n    }\n  };\n}\nfunction customSubmitImpl(options) {\n  const {\n    inst,\n    file,\n    data,\n    headers,\n    withCredentials,\n    action,\n    customRequest\n  } = options;\n  const {\n    doChange\n  } = options.inst;\n  let percentage = 0;\n  customRequest({\n    file,\n    data,\n    headers,\n    withCredentials,\n    action,\n    onProgress(event) {\n      const fileAfterChange = Object.assign({}, file, {\n        status: 'uploading'\n      });\n      const progress = event.percent;\n      fileAfterChange.percentage = progress;\n      percentage = progress;\n      doChange(fileAfterChange);\n    },\n    onFinish() {\n      var _a;\n      let fileAfterChange = Object.assign({}, file, {\n        status: 'finished',\n        percentage,\n        file: null\n      });\n      fileAfterChange = createSettledFileInfo(((_a = inst.onFinish) === null || _a === void 0 ? void 0 : _a.call(inst, {\n        file: fileAfterChange\n      })) || fileAfterChange);\n      doChange(fileAfterChange);\n    },\n    onError() {\n      var _a;\n      let fileAfterChange = Object.assign({}, file, {\n        status: 'error',\n        percentage\n      });\n      fileAfterChange = createSettledFileInfo(((_a = inst.onError) === null || _a === void 0 ? void 0 : _a.call(inst, {\n        file: fileAfterChange\n      })) || fileAfterChange);\n      doChange(fileAfterChange);\n    }\n  });\n}\nfunction registerHandler(inst, file, request) {\n  const handlers = createXhrHandlers(inst, file, request);\n  request.onabort = handlers.handleXHRAbort;\n  request.onerror = handlers.handleXHRError;\n  request.onload = handlers.handleXHRLoad;\n  if (request.upload) {\n    request.upload.onprogress = handlers.handleXHRProgress;\n  }\n}\nfunction unwrapFunctionValue(data, file) {\n  if (typeof data === 'function') {\n    return data({\n      file\n    });\n  }\n  if (data) return data;\n  return {};\n}\nfunction setHeaders(request, headers, file) {\n  const headersObject = unwrapFunctionValue(headers, file);\n  if (!headersObject) return;\n  Object.keys(headersObject).forEach(key => {\n    request.setRequestHeader(key, headersObject[key]);\n  });\n}\nfunction appendData(formData, data, file) {\n  const dataObject = unwrapFunctionValue(data, file);\n  if (!dataObject) return;\n  Object.keys(dataObject).forEach(key => {\n    formData.append(key, dataObject[key]);\n  });\n}\nfunction submitImpl(inst, fieldName, file, {\n  method,\n  action,\n  withCredentials,\n  responseType,\n  headers,\n  data\n}) {\n  const request = new XMLHttpRequest();\n  request.responseType = responseType;\n  inst.xhrMap.set(file.id, request);\n  request.withCredentials = withCredentials;\n  const formData = new FormData();\n  appendData(formData, data, file);\n  formData.append(fieldName, file.file);\n  registerHandler(inst, file, request);\n  if (action !== undefined) {\n    request.open(method.toUpperCase(), action);\n    setHeaders(request, headers, file);\n    request.send(formData);\n    const fileAfterChange = Object.assign({}, file, {\n      status: 'uploading'\n    });\n    inst.doChange(fileAfterChange);\n  }\n}\nexport const uploadProps = Object.assign(Object.assign({}, useTheme.props), {\n  name: {\n    type: String,\n    default: 'file'\n  },\n  accept: String,\n  action: String,\n  customRequest: Function,\n  directory: Boolean,\n  directoryDnd: {\n    type: Boolean,\n    default: undefined\n  },\n  method: {\n    type: String,\n    default: 'POST'\n  },\n  multiple: Boolean,\n  showFileList: {\n    type: Boolean,\n    default: true\n  },\n  data: [Object, Function],\n  headers: [Object, Function],\n  withCredentials: Boolean,\n  responseType: {\n    type: String,\n    default: ''\n  },\n  disabled: {\n    type: Boolean,\n    default: undefined\n  },\n  onChange: Function,\n  onRemove: Function,\n  onFinish: Function,\n  onError: Function,\n  onBeforeUpload: Function,\n  isErrorState: Function,\n  /** currently not used */\n  onDownload: Function,\n  defaultUpload: {\n    type: Boolean,\n    default: true\n  },\n  fileList: Array,\n  'onUpdate:fileList': [Function, Array],\n  onUpdateFileList: [Function, Array],\n  fileListStyle: [String, Object],\n  defaultFileList: {\n    type: Array,\n    default: () => []\n  },\n  showCancelButton: {\n    type: Boolean,\n    default: true\n  },\n  showRemoveButton: {\n    type: Boolean,\n    default: true\n  },\n  showDownloadButton: Boolean,\n  showRetryButton: {\n    type: Boolean,\n    default: true\n  },\n  showPreviewButton: {\n    type: Boolean,\n    default: true\n  },\n  listType: {\n    type: String,\n    default: 'text'\n  },\n  onPreview: Function,\n  createThumbnailUrl: Function,\n  abstract: Boolean,\n  max: Number,\n  showTrigger: {\n    type: Boolean,\n    default: true\n  },\n  imageGroupProps: Object,\n  inputProps: Object,\n  triggerStyle: [String, Object]\n});\nexport default defineComponent({\n  name: 'Upload',\n  props: uploadProps,\n  setup(props) {\n    if (props.abstract && props.listType === 'image-card') {\n      throwError('upload', 'when the list-type is image-card, abstract is not supported.');\n    }\n    const {\n      mergedClsPrefixRef,\n      inlineThemeDisabled\n    } = useConfig(props);\n    const themeRef = useTheme('Upload', '-upload', style, uploadLight, props, mergedClsPrefixRef);\n    const formItem = useFormItem(props);\n    const maxReachedRef = computed(() => {\n      const {\n        max\n      } = props;\n      if (max !== undefined) {\n        return mergedFileListRef.value.length >= max;\n      }\n      return false;\n    });\n    const uncontrolledFileListRef = ref(props.defaultFileList);\n    const controlledFileListRef = toRef(props, 'fileList');\n    const inputElRef = ref(null);\n    const draggerInsideRef = {\n      value: false\n    };\n    const dragOverRef = ref(false);\n    const xhrMap = new Map();\n    const _mergedFileListRef = useMergedState(controlledFileListRef, uncontrolledFileListRef);\n    const mergedFileListRef = computed(() => _mergedFileListRef.value.map(createSettledFileInfo));\n    function openOpenFileDialog() {\n      var _a;\n      (_a = inputElRef.value) === null || _a === void 0 ? void 0 : _a.click();\n    }\n    function handleFileInputChange(e) {\n      const target = e.target;\n      handleFileAddition(target.files ? Array.from(target.files).map(file => ({\n        file,\n        entry: null,\n        source: 'input'\n      })) : null, e);\n      // May have bug! set to null?\n      target.value = '';\n    }\n    function doUpdateFileList(files) {\n      const {\n        'onUpdate:fileList': _onUpdateFileList,\n        onUpdateFileList\n      } = props;\n      if (_onUpdateFileList) call(_onUpdateFileList, files);\n      if (onUpdateFileList) call(onUpdateFileList, files);\n      uncontrolledFileListRef.value = files;\n    }\n    const mergedMultipleRef = computed(() => props.multiple || props.directory);\n    function handleFileAddition(fileAndEntries, e) {\n      if (!fileAndEntries || fileAndEntries.length === 0) return;\n      const {\n        onBeforeUpload\n      } = props;\n      fileAndEntries = mergedMultipleRef.value ? fileAndEntries : [fileAndEntries[0]];\n      const {\n        max,\n        accept\n      } = props;\n      fileAndEntries = fileAndEntries.filter(({\n        file,\n        source\n      }) => {\n        if (source === 'dnd' && (accept === null || accept === void 0 ? void 0 : accept.trim())) {\n          return matchType(file.name, file.type, accept);\n        } else {\n          return true;\n        }\n      });\n      if (max) {\n        fileAndEntries = fileAndEntries.slice(0, max - mergedFileListRef.value.length);\n      }\n      const batchId = createId();\n      void Promise.all(fileAndEntries.map(({\n        file,\n        entry\n      }) => __awaiter(this, void 0, void 0, function* () {\n        var _a;\n        const fileInfo = {\n          id: createId(),\n          batchId,\n          name: file.name,\n          status: 'pending',\n          percentage: 0,\n          file,\n          url: null,\n          type: file.type,\n          thumbnailUrl: null,\n          fullPath: (_a = entry === null || entry === void 0 ? void 0 : entry.fullPath) !== null && _a !== void 0 ? _a : `/${file.webkitRelativePath || file.name}`\n        };\n        if (!onBeforeUpload || (yield onBeforeUpload({\n          file: fileInfo,\n          fileList: mergedFileListRef.value\n        })) !== false) {\n          return fileInfo;\n        }\n        return null;\n      }))).then(fileInfos => __awaiter(this, void 0, void 0, function* () {\n        let nextTickChain = Promise.resolve();\n        fileInfos.forEach(fileInfo => {\n          nextTickChain = nextTickChain.then(nextTick).then(() => {\n            fileInfo && doChange(fileInfo, e, {\n              append: true\n            });\n          });\n        });\n        return yield nextTickChain;\n      })).then(() => {\n        if (props.defaultUpload) {\n          submit();\n        }\n      });\n    }\n    function submit(fileId) {\n      const {\n        method,\n        action,\n        withCredentials,\n        headers,\n        data,\n        name: fieldName\n      } = props;\n      const filesToUpload = fileId !== undefined ? mergedFileListRef.value.filter(file => file.id === fileId) : mergedFileListRef.value;\n      const shouldReupload = fileId !== undefined;\n      filesToUpload.forEach(file => {\n        const {\n          status\n        } = file;\n        if (status === 'pending' || status === 'error' && shouldReupload) {\n          if (props.customRequest) {\n            customSubmitImpl({\n              inst: {\n                doChange,\n                xhrMap,\n                onFinish: props.onFinish,\n                onError: props.onError\n              },\n              file,\n              action,\n              withCredentials,\n              headers,\n              data,\n              customRequest: props.customRequest\n            });\n          } else {\n            submitImpl({\n              doChange,\n              xhrMap,\n              onFinish: props.onFinish,\n              onError: props.onError,\n              isErrorState: props.isErrorState\n            }, fieldName, file, {\n              method,\n              action,\n              withCredentials,\n              responseType: props.responseType,\n              headers,\n              data\n            });\n          }\n        }\n      });\n    }\n    const doChange = (fileAfterChange, event, options = {\n      append: false,\n      remove: false\n    }) => {\n      const {\n        append,\n        remove\n      } = options;\n      const fileListAfterChange = Array.from(mergedFileListRef.value);\n      const fileIndex = fileListAfterChange.findIndex(file => file.id === fileAfterChange.id);\n      if (append || remove || ~fileIndex) {\n        if (append) {\n          fileListAfterChange.push(fileAfterChange);\n        } else if (remove) {\n          fileListAfterChange.splice(fileIndex, 1);\n        } else {\n          fileListAfterChange.splice(fileIndex, 1, fileAfterChange);\n        }\n        const {\n          onChange\n        } = props;\n        if (onChange) {\n          onChange({\n            file: fileAfterChange,\n            fileList: fileListAfterChange,\n            event\n          });\n        }\n        doUpdateFileList(fileListAfterChange);\n      } else if (process.env.NODE_ENV !== 'production') {\n        warn('upload', 'File has no corresponding id in current file list.');\n      }\n    };\n    function getFileThumbnailUrl(file) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const {\n          createThumbnailUrl\n        } = props;\n        return createThumbnailUrl ? yield createThumbnailUrl(file.file) : yield createImageDataUrl(file.file);\n      });\n    }\n    const cssVarsRef = computed(() => {\n      const {\n        common: {\n          cubicBezierEaseInOut\n        },\n        self: {\n          draggerColor,\n          draggerBorder,\n          draggerBorderHover,\n          itemColorHover,\n          itemColorHoverError,\n          itemTextColorError,\n          itemTextColorSuccess,\n          itemTextColor,\n          itemIconColor,\n          itemDisabledOpacity,\n          lineHeight,\n          borderRadius,\n          fontSize,\n          itemBorderImageCardError,\n          itemBorderImageCard\n        }\n      } = themeRef.value;\n      return {\n        '--n-bezier': cubicBezierEaseInOut,\n        '--n-border-radius': borderRadius,\n        '--n-dragger-border': draggerBorder,\n        '--n-dragger-border-hover': draggerBorderHover,\n        '--n-dragger-color': draggerColor,\n        '--n-font-size': fontSize,\n        '--n-item-color-hover': itemColorHover,\n        '--n-item-color-hover-error': itemColorHoverError,\n        '--n-item-disabled-opacity': itemDisabledOpacity,\n        '--n-item-icon-color': itemIconColor,\n        '--n-item-text-color': itemTextColor,\n        '--n-item-text-color-error': itemTextColorError,\n        '--n-item-text-color-success': itemTextColorSuccess,\n        '--n-line-height': lineHeight,\n        '--n-item-border-image-card-error': itemBorderImageCardError,\n        '--n-item-border-image-card': itemBorderImageCard\n      };\n    });\n    const themeClassHandle = inlineThemeDisabled ? useThemeClass('upload', undefined, cssVarsRef, props) : undefined;\n    provide(uploadInjectionKey, {\n      mergedClsPrefixRef,\n      mergedThemeRef: themeRef,\n      showCancelButtonRef: toRef(props, 'showCancelButton'),\n      showDownloadButtonRef: toRef(props, 'showDownloadButton'),\n      showRemoveButtonRef: toRef(props, 'showRemoveButton'),\n      showRetryButtonRef: toRef(props, 'showRetryButton'),\n      onRemoveRef: toRef(props, 'onRemove'),\n      onDownloadRef: toRef(props, 'onDownload'),\n      mergedFileListRef,\n      triggerStyleRef: toRef(props, 'triggerStyle'),\n      xhrMap,\n      submit,\n      doChange,\n      showPreviewButtonRef: toRef(props, 'showPreviewButton'),\n      onPreviewRef: toRef(props, 'onPreview'),\n      getFileThumbnailUrl,\n      listTypeRef: toRef(props, 'listType'),\n      dragOverRef,\n      openOpenFileDialog,\n      draggerInsideRef,\n      handleFileAddition,\n      mergedDisabledRef: formItem.mergedDisabledRef,\n      maxReachedRef,\n      fileListStyleRef: toRef(props, 'fileListStyle'),\n      abstractRef: toRef(props, 'abstract'),\n      acceptRef: toRef(props, 'accept'),\n      cssVarsRef: inlineThemeDisabled ? undefined : cssVarsRef,\n      themeClassRef: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n      onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender,\n      showTriggerRef: toRef(props, 'showTrigger'),\n      imageGroupPropsRef: toRef(props, 'imageGroupProps'),\n      mergedDirectoryDndRef: computed(() => {\n        var _a;\n        return (_a = props.directoryDnd) !== null && _a !== void 0 ? _a : props.directory;\n      })\n    });\n    const exposedMethods = {\n      clear: () => {\n        uncontrolledFileListRef.value = [];\n      },\n      submit,\n      openOpenFileDialog\n    };\n    return Object.assign({\n      mergedClsPrefix: mergedClsPrefixRef,\n      draggerInsideRef,\n      inputElRef,\n      mergedTheme: themeRef,\n      dragOver: dragOverRef,\n      mergedMultiple: mergedMultipleRef,\n      cssVars: inlineThemeDisabled ? undefined : cssVarsRef,\n      themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n      onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender,\n      handleFileInputChange\n    }, exposedMethods);\n  },\n  render() {\n    var _a, _b;\n    const {\n      draggerInsideRef,\n      mergedClsPrefix,\n      $slots,\n      directory,\n      onRender\n    } = this;\n    if ($slots.default && !this.abstract) {\n      const firstChild = $slots.default()[0];\n      if ((_a = firstChild === null || firstChild === void 0 ? void 0 : firstChild.type) === null || _a === void 0 ? void 0 : _a[uploadDraggerKey]) {\n        draggerInsideRef.value = true;\n      }\n    }\n    const inputNode = h(\"input\", Object.assign({}, this.inputProps, {\n      ref: \"inputElRef\",\n      type: \"file\",\n      class: `${mergedClsPrefix}-upload-file-input`,\n      accept: this.accept,\n      multiple: this.mergedMultiple,\n      onChange: this.handleFileInputChange,\n      // eslint-disable-next-line @typescript-eslint/prefer-ts-expect-error\n      // @ts-ignore // seems vue-tsc will add the prop, so we can't use expect-error\n      webkitdirectory: directory || undefined,\n      directory: directory || undefined\n    }));\n    if (this.abstract) {\n      return h(Fragment, null, (_b = $slots.default) === null || _b === void 0 ? void 0 : _b.call($slots), h(Teleport, {\n        to: \"body\"\n      }, inputNode));\n    }\n    onRender === null || onRender === void 0 ? void 0 : onRender();\n    return h(\"div\", {\n      class: [`${mergedClsPrefix}-upload`, draggerInsideRef.value && `${mergedClsPrefix}-upload--dragger-inside`, this.dragOver && `${mergedClsPrefix}-upload--drag-over`, this.themeClass],\n      style: this.cssVars\n    }, inputNode, this.showTrigger && this.listType !== 'image-card' && h(NUploadTrigger, null, $slots), this.showFileList && h(NUploadFileList, null, $slots));\n  }\n});","map":{"version":3,"names":["__awaiter","thisArg","_arguments","P","generator","adopt","value","resolve","Promise","reject","fulfilled","step","next","e","rejected","result","done","then","apply","h","defineComponent","computed","provide","toRef","ref","Fragment","Teleport","nextTick","createId","useMergedState","useConfig","useTheme","useFormItem","useThemeClass","warn","call","throwError","uploadLight","uploadDraggerKey","uploadInjectionKey","createImageDataUrl","createSettledFileInfo","matchType","NUploadTrigger","NUploadFileList","style","createXhrHandlers","inst","file","xhr","doChange","xhrMap","percentage","handleXHRError","_a","fileAfterChange","Object","assign","status","delete","id","onError","event","handleXHRLoad","isErrorState","onFinish","handleXHRAbort","handleXHRProgress","lengthComputable","progress","Math","ceil","loaded","total","customSubmitImpl","options","data","headers","withCredentials","action","customRequest","onProgress","percent","registerHandler","request","handlers","onabort","onerror","onload","upload","onprogress","unwrapFunctionValue","setHeaders","headersObject","keys","forEach","key","setRequestHeader","appendData","formData","dataObject","append","submitImpl","fieldName","method","responseType","XMLHttpRequest","set","FormData","undefined","open","toUpperCase","send","uploadProps","props","name","type","String","default","accept","Function","directory","Boolean","directoryDnd","multiple","showFileList","disabled","onChange","onRemove","onBeforeUpload","onDownload","defaultUpload","fileList","Array","onUpdateFileList","fileListStyle","defaultFileList","showCancelButton","showRemoveButton","showDownloadButton","showRetryButton","showPreviewButton","listType","onPreview","createThumbnailUrl","abstract","max","Number","showTrigger","imageGroupProps","inputProps","triggerStyle","setup","mergedClsPrefixRef","inlineThemeDisabled","themeRef","formItem","maxReachedRef","mergedFileListRef","length","uncontrolledFileListRef","controlledFileListRef","inputElRef","draggerInsideRef","dragOverRef","Map","_mergedFileListRef","map","openOpenFileDialog","click","handleFileInputChange","target","handleFileAddition","files","from","entry","source","doUpdateFileList","_onUpdateFileList","mergedMultipleRef","fileAndEntries","filter","trim","slice","batchId","all","fileInfo","url","thumbnailUrl","fullPath","webkitRelativePath","fileInfos","nextTickChain","submit","fileId","filesToUpload","shouldReupload","remove","fileListAfterChange","fileIndex","findIndex","push","splice","process","env","NODE_ENV","getFileThumbnailUrl","cssVarsRef","common","cubicBezierEaseInOut","self","draggerColor","draggerBorder","draggerBorderHover","itemColorHover","itemColorHoverError","itemTextColorError","itemTextColorSuccess","itemTextColor","itemIconColor","itemDisabledOpacity","lineHeight","borderRadius","fontSize","itemBorderImageCardError","itemBorderImageCard","themeClassHandle","mergedThemeRef","showCancelButtonRef","showDownloadButtonRef","showRemoveButtonRef","showRetryButtonRef","onRemoveRef","onDownloadRef","triggerStyleRef","showPreviewButtonRef","onPreviewRef","listTypeRef","mergedDisabledRef","fileListStyleRef","abstractRef","acceptRef","themeClassRef","themeClass","onRender","showTriggerRef","imageGroupPropsRef","mergedDirectoryDndRef","exposedMethods","clear","mergedClsPrefix","mergedTheme","dragOver","mergedMultiple","cssVars","render","_b","$slots","firstChild","inputNode","class","webkitdirectory","to"],"sources":["/Users/krystal/Documents/GitHub/meetings_vue3/node_modules/naive-ui/es/upload/src/Upload.js"],"sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { h, defineComponent, computed, provide, toRef, ref, Fragment, Teleport, nextTick } from 'vue';\nimport { createId } from 'seemly';\nimport { useMergedState } from 'vooks';\nimport { useConfig, useTheme, useFormItem, useThemeClass } from '../../_mixins';\nimport { warn, call, throwError } from '../../_utils';\nimport { uploadLight } from '../styles';\nimport { uploadDraggerKey } from './UploadDragger';\nimport { uploadInjectionKey } from './interface';\nimport { createImageDataUrl, createSettledFileInfo, matchType } from './utils';\nimport NUploadTrigger from './UploadTrigger';\nimport NUploadFileList from './UploadFileList';\nimport style from './styles/index.cssr';\n/**\n * fils status ['pending', 'uploading', 'finished', 'removed', 'error']\n */\nfunction createXhrHandlers(inst, file, xhr) {\n    const { doChange, xhrMap } = inst;\n    let percentage = 0;\n    function handleXHRError(e) {\n        var _a;\n        let fileAfterChange = Object.assign({}, file, {\n            status: 'error',\n            percentage\n        });\n        xhrMap.delete(file.id);\n        fileAfterChange = createSettledFileInfo(((_a = inst.onError) === null || _a === void 0 ? void 0 : _a.call(inst, { file: fileAfterChange, event: e })) || fileAfterChange);\n        doChange(fileAfterChange, e);\n    }\n    function handleXHRLoad(e) {\n        var _a;\n        if (inst.isErrorState) {\n            if (inst.isErrorState(xhr)) {\n                handleXHRError(e);\n                return;\n            }\n        }\n        else {\n            if (xhr.status < 200 || xhr.status >= 300) {\n                handleXHRError(e);\n                return;\n            }\n        }\n        let fileAfterChange = Object.assign({}, file, {\n            status: 'finished',\n            percentage,\n            file: null\n        });\n        xhrMap.delete(file.id);\n        fileAfterChange = createSettledFileInfo(((_a = inst.onFinish) === null || _a === void 0 ? void 0 : _a.call(inst, { file: fileAfterChange, event: e })) || fileAfterChange);\n        doChange(fileAfterChange, e);\n    }\n    return {\n        handleXHRLoad,\n        handleXHRError,\n        handleXHRAbort(e) {\n            const fileAfterChange = Object.assign({}, file, {\n                status: 'removed',\n                file: null,\n                percentage\n            });\n            xhrMap.delete(file.id);\n            doChange(fileAfterChange, e);\n        },\n        handleXHRProgress(e) {\n            const fileAfterChange = Object.assign({}, file, {\n                status: 'uploading'\n            });\n            if (e.lengthComputable) {\n                const progress = Math.ceil((e.loaded / e.total) * 100);\n                fileAfterChange.percentage = progress;\n                percentage = progress;\n            }\n            doChange(fileAfterChange, e);\n        }\n    };\n}\nfunction customSubmitImpl(options) {\n    const { inst, file, data, headers, withCredentials, action, customRequest } = options;\n    const { doChange } = options.inst;\n    let percentage = 0;\n    customRequest({\n        file,\n        data,\n        headers,\n        withCredentials,\n        action,\n        onProgress(event) {\n            const fileAfterChange = Object.assign({}, file, {\n                status: 'uploading'\n            });\n            const progress = event.percent;\n            fileAfterChange.percentage = progress;\n            percentage = progress;\n            doChange(fileAfterChange);\n        },\n        onFinish() {\n            var _a;\n            let fileAfterChange = Object.assign({}, file, {\n                status: 'finished',\n                percentage,\n                file: null\n            });\n            fileAfterChange = createSettledFileInfo(((_a = inst.onFinish) === null || _a === void 0 ? void 0 : _a.call(inst, { file: fileAfterChange })) || fileAfterChange);\n            doChange(fileAfterChange);\n        },\n        onError() {\n            var _a;\n            let fileAfterChange = Object.assign({}, file, {\n                status: 'error',\n                percentage\n            });\n            fileAfterChange = createSettledFileInfo(((_a = inst.onError) === null || _a === void 0 ? void 0 : _a.call(inst, { file: fileAfterChange })) || fileAfterChange);\n            doChange(fileAfterChange);\n        }\n    });\n}\nfunction registerHandler(inst, file, request) {\n    const handlers = createXhrHandlers(inst, file, request);\n    request.onabort = handlers.handleXHRAbort;\n    request.onerror = handlers.handleXHRError;\n    request.onload = handlers.handleXHRLoad;\n    if (request.upload) {\n        request.upload.onprogress = handlers.handleXHRProgress;\n    }\n}\nfunction unwrapFunctionValue(data, file) {\n    if (typeof data === 'function') {\n        return data({ file });\n    }\n    if (data)\n        return data;\n    return {};\n}\nfunction setHeaders(request, headers, file) {\n    const headersObject = unwrapFunctionValue(headers, file);\n    if (!headersObject)\n        return;\n    Object.keys(headersObject).forEach((key) => {\n        request.setRequestHeader(key, headersObject[key]);\n    });\n}\nfunction appendData(formData, data, file) {\n    const dataObject = unwrapFunctionValue(data, file);\n    if (!dataObject)\n        return;\n    Object.keys(dataObject).forEach((key) => {\n        formData.append(key, dataObject[key]);\n    });\n}\nfunction submitImpl(inst, fieldName, file, { method, action, withCredentials, responseType, headers, data }) {\n    const request = new XMLHttpRequest();\n    request.responseType = responseType;\n    inst.xhrMap.set(file.id, request);\n    request.withCredentials = withCredentials;\n    const formData = new FormData();\n    appendData(formData, data, file);\n    formData.append(fieldName, file.file);\n    registerHandler(inst, file, request);\n    if (action !== undefined) {\n        request.open(method.toUpperCase(), action);\n        setHeaders(request, headers, file);\n        request.send(formData);\n        const fileAfterChange = Object.assign({}, file, {\n            status: 'uploading'\n        });\n        inst.doChange(fileAfterChange);\n    }\n}\nexport const uploadProps = Object.assign(Object.assign({}, useTheme.props), { name: {\n        type: String,\n        default: 'file'\n    }, accept: String, action: String, customRequest: Function, directory: Boolean, directoryDnd: { type: Boolean, default: undefined }, method: {\n        type: String,\n        default: 'POST'\n    }, multiple: Boolean, showFileList: {\n        type: Boolean,\n        default: true\n    }, data: [Object, Function], headers: [Object, Function], withCredentials: Boolean, responseType: {\n        type: String,\n        default: ''\n    }, disabled: {\n        type: Boolean,\n        default: undefined\n    }, onChange: Function, onRemove: Function, onFinish: Function, onError: Function, onBeforeUpload: Function, isErrorState: Function, \n    /** currently not used */\n    onDownload: Function, defaultUpload: {\n        type: Boolean,\n        default: true\n    }, fileList: Array, 'onUpdate:fileList': [Function, Array], onUpdateFileList: [Function, Array], fileListStyle: [String, Object], defaultFileList: {\n        type: Array,\n        default: () => []\n    }, showCancelButton: {\n        type: Boolean,\n        default: true\n    }, showRemoveButton: {\n        type: Boolean,\n        default: true\n    }, showDownloadButton: Boolean, showRetryButton: {\n        type: Boolean,\n        default: true\n    }, showPreviewButton: {\n        type: Boolean,\n        default: true\n    }, listType: {\n        type: String,\n        default: 'text'\n    }, onPreview: Function, createThumbnailUrl: Function, abstract: Boolean, max: Number, showTrigger: {\n        type: Boolean,\n        default: true\n    }, imageGroupProps: Object, inputProps: Object, triggerStyle: [String, Object] });\nexport default defineComponent({\n    name: 'Upload',\n    props: uploadProps,\n    setup(props) {\n        if (props.abstract && props.listType === 'image-card') {\n            throwError('upload', 'when the list-type is image-card, abstract is not supported.');\n        }\n        const { mergedClsPrefixRef, inlineThemeDisabled } = useConfig(props);\n        const themeRef = useTheme('Upload', '-upload', style, uploadLight, props, mergedClsPrefixRef);\n        const formItem = useFormItem(props);\n        const maxReachedRef = computed(() => {\n            const { max } = props;\n            if (max !== undefined) {\n                return mergedFileListRef.value.length >= max;\n            }\n            return false;\n        });\n        const uncontrolledFileListRef = ref(props.defaultFileList);\n        const controlledFileListRef = toRef(props, 'fileList');\n        const inputElRef = ref(null);\n        const draggerInsideRef = {\n            value: false\n        };\n        const dragOverRef = ref(false);\n        const xhrMap = new Map();\n        const _mergedFileListRef = useMergedState(controlledFileListRef, uncontrolledFileListRef);\n        const mergedFileListRef = computed(() => _mergedFileListRef.value.map(createSettledFileInfo));\n        function openOpenFileDialog() {\n            var _a;\n            (_a = inputElRef.value) === null || _a === void 0 ? void 0 : _a.click();\n        }\n        function handleFileInputChange(e) {\n            const target = e.target;\n            handleFileAddition(target.files\n                ? Array.from(target.files).map((file) => ({\n                    file,\n                    entry: null,\n                    source: 'input'\n                }))\n                : null, e);\n            // May have bug! set to null?\n            target.value = '';\n        }\n        function doUpdateFileList(files) {\n            const { 'onUpdate:fileList': _onUpdateFileList, onUpdateFileList } = props;\n            if (_onUpdateFileList)\n                call(_onUpdateFileList, files);\n            if (onUpdateFileList)\n                call(onUpdateFileList, files);\n            uncontrolledFileListRef.value = files;\n        }\n        const mergedMultipleRef = computed(() => props.multiple || props.directory);\n        function handleFileAddition(fileAndEntries, e) {\n            if (!fileAndEntries || fileAndEntries.length === 0)\n                return;\n            const { onBeforeUpload } = props;\n            fileAndEntries = mergedMultipleRef.value\n                ? fileAndEntries\n                : [fileAndEntries[0]];\n            const { max, accept } = props;\n            fileAndEntries = fileAndEntries.filter(({ file, source }) => {\n                if (source === 'dnd' && (accept === null || accept === void 0 ? void 0 : accept.trim())) {\n                    return matchType(file.name, file.type, accept);\n                }\n                else {\n                    return true;\n                }\n            });\n            if (max) {\n                fileAndEntries = fileAndEntries.slice(0, max - mergedFileListRef.value.length);\n            }\n            const batchId = createId();\n            void Promise.all(fileAndEntries.map(({ file, entry }) => __awaiter(this, void 0, void 0, function* () {\n                var _a;\n                const fileInfo = {\n                    id: createId(),\n                    batchId,\n                    name: file.name,\n                    status: 'pending',\n                    percentage: 0,\n                    file,\n                    url: null,\n                    type: file.type,\n                    thumbnailUrl: null,\n                    fullPath: (_a = entry === null || entry === void 0 ? void 0 : entry.fullPath) !== null && _a !== void 0 ? _a : `/${file.webkitRelativePath || file.name}`\n                };\n                if (!onBeforeUpload ||\n                    (yield onBeforeUpload({\n                        file: fileInfo,\n                        fileList: mergedFileListRef.value\n                    })) !== false) {\n                    return fileInfo;\n                }\n                return null;\n            })))\n                .then((fileInfos) => __awaiter(this, void 0, void 0, function* () {\n                let nextTickChain = Promise.resolve();\n                fileInfos.forEach((fileInfo) => {\n                    nextTickChain = nextTickChain.then(nextTick).then(() => {\n                        fileInfo &&\n                            doChange(fileInfo, e, {\n                                append: true\n                            });\n                    });\n                });\n                return yield nextTickChain;\n            }))\n                .then(() => {\n                if (props.defaultUpload) {\n                    submit();\n                }\n            });\n        }\n        function submit(fileId) {\n            const { method, action, withCredentials, headers, data, name: fieldName } = props;\n            const filesToUpload = fileId !== undefined\n                ? mergedFileListRef.value.filter((file) => file.id === fileId)\n                : mergedFileListRef.value;\n            const shouldReupload = fileId !== undefined;\n            filesToUpload.forEach((file) => {\n                const { status } = file;\n                if (status === 'pending' || (status === 'error' && shouldReupload)) {\n                    if (props.customRequest) {\n                        customSubmitImpl({\n                            inst: {\n                                doChange,\n                                xhrMap,\n                                onFinish: props.onFinish,\n                                onError: props.onError\n                            },\n                            file,\n                            action,\n                            withCredentials,\n                            headers,\n                            data,\n                            customRequest: props.customRequest\n                        });\n                    }\n                    else {\n                        submitImpl({\n                            doChange,\n                            xhrMap,\n                            onFinish: props.onFinish,\n                            onError: props.onError,\n                            isErrorState: props.isErrorState\n                        }, fieldName, file, {\n                            method,\n                            action,\n                            withCredentials,\n                            responseType: props.responseType,\n                            headers,\n                            data\n                        });\n                    }\n                }\n            });\n        }\n        const doChange = (fileAfterChange, event, options = {\n            append: false,\n            remove: false\n        }) => {\n            const { append, remove } = options;\n            const fileListAfterChange = Array.from(mergedFileListRef.value);\n            const fileIndex = fileListAfterChange.findIndex((file) => file.id === fileAfterChange.id);\n            if (append || remove || ~fileIndex) {\n                if (append) {\n                    fileListAfterChange.push(fileAfterChange);\n                }\n                else if (remove) {\n                    fileListAfterChange.splice(fileIndex, 1);\n                }\n                else {\n                    fileListAfterChange.splice(fileIndex, 1, fileAfterChange);\n                }\n                const { onChange } = props;\n                if (onChange) {\n                    onChange({\n                        file: fileAfterChange,\n                        fileList: fileListAfterChange,\n                        event\n                    });\n                }\n                doUpdateFileList(fileListAfterChange);\n            }\n            else if (process.env.NODE_ENV !== 'production') {\n                warn('upload', 'File has no corresponding id in current file list.');\n            }\n        };\n        function getFileThumbnailUrl(file) {\n            return __awaiter(this, void 0, void 0, function* () {\n                const { createThumbnailUrl } = props;\n                return createThumbnailUrl\n                    ? yield createThumbnailUrl(file.file)\n                    : yield createImageDataUrl(file.file);\n            });\n        }\n        const cssVarsRef = computed(() => {\n            const { common: { cubicBezierEaseInOut }, self: { draggerColor, draggerBorder, draggerBorderHover, itemColorHover, itemColorHoverError, itemTextColorError, itemTextColorSuccess, itemTextColor, itemIconColor, itemDisabledOpacity, lineHeight, borderRadius, fontSize, itemBorderImageCardError, itemBorderImageCard } } = themeRef.value;\n            return {\n                '--n-bezier': cubicBezierEaseInOut,\n                '--n-border-radius': borderRadius,\n                '--n-dragger-border': draggerBorder,\n                '--n-dragger-border-hover': draggerBorderHover,\n                '--n-dragger-color': draggerColor,\n                '--n-font-size': fontSize,\n                '--n-item-color-hover': itemColorHover,\n                '--n-item-color-hover-error': itemColorHoverError,\n                '--n-item-disabled-opacity': itemDisabledOpacity,\n                '--n-item-icon-color': itemIconColor,\n                '--n-item-text-color': itemTextColor,\n                '--n-item-text-color-error': itemTextColorError,\n                '--n-item-text-color-success': itemTextColorSuccess,\n                '--n-line-height': lineHeight,\n                '--n-item-border-image-card-error': itemBorderImageCardError,\n                '--n-item-border-image-card': itemBorderImageCard\n            };\n        });\n        const themeClassHandle = inlineThemeDisabled\n            ? useThemeClass('upload', undefined, cssVarsRef, props)\n            : undefined;\n        provide(uploadInjectionKey, {\n            mergedClsPrefixRef,\n            mergedThemeRef: themeRef,\n            showCancelButtonRef: toRef(props, 'showCancelButton'),\n            showDownloadButtonRef: toRef(props, 'showDownloadButton'),\n            showRemoveButtonRef: toRef(props, 'showRemoveButton'),\n            showRetryButtonRef: toRef(props, 'showRetryButton'),\n            onRemoveRef: toRef(props, 'onRemove'),\n            onDownloadRef: toRef(props, 'onDownload'),\n            mergedFileListRef,\n            triggerStyleRef: toRef(props, 'triggerStyle'),\n            xhrMap,\n            submit,\n            doChange,\n            showPreviewButtonRef: toRef(props, 'showPreviewButton'),\n            onPreviewRef: toRef(props, 'onPreview'),\n            getFileThumbnailUrl,\n            listTypeRef: toRef(props, 'listType'),\n            dragOverRef,\n            openOpenFileDialog,\n            draggerInsideRef,\n            handleFileAddition,\n            mergedDisabledRef: formItem.mergedDisabledRef,\n            maxReachedRef,\n            fileListStyleRef: toRef(props, 'fileListStyle'),\n            abstractRef: toRef(props, 'abstract'),\n            acceptRef: toRef(props, 'accept'),\n            cssVarsRef: inlineThemeDisabled ? undefined : cssVarsRef,\n            themeClassRef: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass,\n            onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender,\n            showTriggerRef: toRef(props, 'showTrigger'),\n            imageGroupPropsRef: toRef(props, 'imageGroupProps'),\n            mergedDirectoryDndRef: computed(() => {\n                var _a;\n                return (_a = props.directoryDnd) !== null && _a !== void 0 ? _a : props.directory;\n            })\n        });\n        const exposedMethods = {\n            clear: () => {\n                uncontrolledFileListRef.value = [];\n            },\n            submit,\n            openOpenFileDialog\n        };\n        return Object.assign({ mergedClsPrefix: mergedClsPrefixRef, draggerInsideRef,\n            inputElRef, mergedTheme: themeRef, dragOver: dragOverRef, mergedMultiple: mergedMultipleRef, cssVars: inlineThemeDisabled ? undefined : cssVarsRef, themeClass: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.themeClass, onRender: themeClassHandle === null || themeClassHandle === void 0 ? void 0 : themeClassHandle.onRender, handleFileInputChange }, exposedMethods);\n    },\n    render() {\n        var _a, _b;\n        const { draggerInsideRef, mergedClsPrefix, $slots, directory, onRender } = this;\n        if ($slots.default && !this.abstract) {\n            const firstChild = $slots.default()[0];\n            if ((_a = firstChild === null || firstChild === void 0 ? void 0 : firstChild.type) === null || _a === void 0 ? void 0 : _a[uploadDraggerKey]) {\n                draggerInsideRef.value = true;\n            }\n        }\n        const inputNode = (h(\"input\", Object.assign({}, this.inputProps, { ref: \"inputElRef\", type: \"file\", class: `${mergedClsPrefix}-upload-file-input`, accept: this.accept, multiple: this.mergedMultiple, onChange: this.handleFileInputChange, \n            // eslint-disable-next-line @typescript-eslint/prefer-ts-expect-error\n            // @ts-ignore // seems vue-tsc will add the prop, so we can't use expect-error\n            webkitdirectory: directory || undefined, directory: directory || undefined })));\n        if (this.abstract) {\n            return (h(Fragment, null, (_b = $slots.default) === null || _b === void 0 ? void 0 :\n                _b.call($slots),\n                h(Teleport, { to: \"body\" }, inputNode)));\n        }\n        onRender === null || onRender === void 0 ? void 0 : onRender();\n        return (h(\"div\", { class: [\n                `${mergedClsPrefix}-upload`,\n                draggerInsideRef.value && `${mergedClsPrefix}-upload--dragger-inside`,\n                this.dragOver && `${mergedClsPrefix}-upload--drag-over`,\n                this.themeClass\n            ], style: this.cssVars },\n            inputNode,\n            this.showTrigger && this.listType !== 'image-card' && (h(NUploadTrigger, null, $slots)),\n            this.showFileList && h(NUploadFileList, null, $slots)));\n    }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}