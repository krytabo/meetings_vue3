{"ast":null,"code":"import { defineComponent, h, ref, provide, getCurrentInstance } from 'vue';\nimport { createId } from 'seemly';\nimport { createInjectionKey } from '../../_utils';\nimport { useConfig } from '../../_mixins';\nimport NImagePreview from './ImagePreview';\nimport { imagePreviewSharedProps } from './interface';\nexport const imageGroupInjectionKey = createInjectionKey('n-image-group');\nexport const imageGroupProps = imagePreviewSharedProps;\nexport default defineComponent({\n  name: 'ImageGroup',\n  props: imageGroupProps,\n  setup(props) {\n    let currentSrc;\n    const {\n      mergedClsPrefixRef\n    } = useConfig(props);\n    const groupId = `c${createId()}`;\n    const vm = getCurrentInstance();\n    const setPreviewSrc = src => {\n      var _a;\n      currentSrc = src;\n      (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setPreviewSrc(src);\n    };\n    function go(step) {\n      if (!(vm === null || vm === void 0 ? void 0 : vm.proxy)) return;\n      const container = vm.proxy.$el.parentElement;\n      // use dom api since we can't get the correct order before all children are rendered\n      const imgs = container.querySelectorAll(`[data-group-id=${groupId}]:not([data-error=true])`);\n      if (!imgs.length) return;\n      const index = Array.from(imgs).findIndex(img => img.dataset.previewSrc === currentSrc);\n      if (~index) {\n        setPreviewSrc(imgs[(index + step + imgs.length) % imgs.length].dataset.previewSrc);\n      } else {\n        setPreviewSrc(imgs[0].dataset.previewSrc);\n      }\n    }\n    provide(imageGroupInjectionKey, {\n      mergedClsPrefixRef,\n      setPreviewSrc,\n      setThumbnailEl: el => {\n        var _a;\n        (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setThumbnailEl(el);\n      },\n      toggleShow: () => {\n        var _a;\n        (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.toggleShow();\n      },\n      groupId\n    });\n    const previewInstRef = ref(null);\n    return {\n      mergedClsPrefix: mergedClsPrefixRef,\n      previewInstRef,\n      next: () => go(1),\n      prev: () => go(-1)\n    };\n  },\n  render() {\n    return h(NImagePreview, {\n      theme: this.theme,\n      themeOverrides: this.themeOverrides,\n      clsPrefix: this.mergedClsPrefix,\n      ref: \"previewInstRef\",\n      onPrev: this.prev,\n      onNext: this.next,\n      showToolbar: this.showToolbar,\n      showToolbarTooltip: this.showToolbarTooltip\n    }, this.$slots);\n  }\n});","map":{"version":3,"names":["defineComponent","h","ref","provide","getCurrentInstance","createId","createInjectionKey","useConfig","NImagePreview","imagePreviewSharedProps","imageGroupInjectionKey","imageGroupProps","name","props","setup","currentSrc","mergedClsPrefixRef","groupId","vm","setPreviewSrc","src","_a","previewInstRef","value","go","step","proxy","container","$el","parentElement","imgs","querySelectorAll","length","index","Array","from","findIndex","img","dataset","previewSrc","setThumbnailEl","el","toggleShow","mergedClsPrefix","next","prev","render","theme","themeOverrides","clsPrefix","onPrev","onNext","showToolbar","showToolbarTooltip","$slots"],"sources":["/Users/elmo/GitHub/meetings_vue3/node_modules/naive-ui/es/image/src/ImageGroup.js"],"sourcesContent":["import { defineComponent, h, ref, provide, getCurrentInstance } from 'vue';\nimport { createId } from 'seemly';\nimport { createInjectionKey } from '../../_utils';\nimport { useConfig } from '../../_mixins';\nimport NImagePreview from './ImagePreview';\nimport { imagePreviewSharedProps } from './interface';\nexport const imageGroupInjectionKey = createInjectionKey('n-image-group');\nexport const imageGroupProps = imagePreviewSharedProps;\nexport default defineComponent({\n    name: 'ImageGroup',\n    props: imageGroupProps,\n    setup(props) {\n        let currentSrc;\n        const { mergedClsPrefixRef } = useConfig(props);\n        const groupId = `c${createId()}`;\n        const vm = getCurrentInstance();\n        const setPreviewSrc = (src) => {\n            var _a;\n            currentSrc = src;\n            (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setPreviewSrc(src);\n        };\n        function go(step) {\n            if (!(vm === null || vm === void 0 ? void 0 : vm.proxy))\n                return;\n            const container = vm.proxy.$el.parentElement;\n            // use dom api since we can't get the correct order before all children are rendered\n            const imgs = container.querySelectorAll(`[data-group-id=${groupId}]:not([data-error=true])`);\n            if (!imgs.length)\n                return;\n            const index = Array.from(imgs).findIndex((img) => img.dataset.previewSrc === currentSrc);\n            if (~index) {\n                setPreviewSrc(imgs[(index + step + imgs.length) % imgs.length].dataset.previewSrc);\n            }\n            else {\n                setPreviewSrc(imgs[0].dataset.previewSrc);\n            }\n        }\n        provide(imageGroupInjectionKey, {\n            mergedClsPrefixRef,\n            setPreviewSrc,\n            setThumbnailEl: (el) => {\n                var _a;\n                (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.setThumbnailEl(el);\n            },\n            toggleShow: () => {\n                var _a;\n                (_a = previewInstRef.value) === null || _a === void 0 ? void 0 : _a.toggleShow();\n            },\n            groupId\n        });\n        const previewInstRef = ref(null);\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            previewInstRef,\n            next: () => go(1),\n            prev: () => go(-1)\n        };\n    },\n    render() {\n        return (h(NImagePreview, { theme: this.theme, themeOverrides: this.themeOverrides, clsPrefix: this.mergedClsPrefix, ref: \"previewInstRef\", onPrev: this.prev, onNext: this.next, showToolbar: this.showToolbar, showToolbarTooltip: this.showToolbarTooltip }, this.$slots));\n    }\n});\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}